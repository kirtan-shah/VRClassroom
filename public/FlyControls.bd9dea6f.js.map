{"version":3,"sources":["javascript/FlyControls.js"],"names":["THREE","FlyControls","object","domElement","bind","scope","fn","apply","arguments","contextmenu","event","preventDefault","undefined","console","warn","document","setAttribute","movementSpeed","rollSpeed","dragToLook","autoForward","tmpQuaternion","Quaternion","mouseStatus","moveState","up","down","left","right","forward","back","pitchUp","pitchDown","yawLeft","yawRight","rollLeft","rollRight","moveVector","Vector3","rotationVector","keydown","altKey","keyCode","movementSpeedMultiplier","updateMovementVector","updateRotationVector","keyup","mousedown","focus","stopPropagation","button","mousemove","container","getContainerDimensions","halfWidth","size","halfHeight","pageX","offset","pageY","mouseup","update","delta","moveMult","rotMult","translateX","x","translateY","y","translateZ","z","set","normalize","quaternion","multiply","rotation","setFromQuaternion","order","offsetWidth","offsetHeight","offsetLeft","offsetTop","window","innerWidth","innerHeight","dispose","removeEventListener","_mousedown","_mousemove","_mouseup","_keydown","_keyup","addEventListener"],"mappings":"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","file":"FlyControls.bd9dea6f.js","sourceRoot":"../front","sourcesContent":["/**\n * @author James Baicoianu / http://www.baicoianu.com/\n */\n\nTHREE.FlyControls = function ( object, domElement ) {\n\n\tif ( domElement === undefined ) {\n\n\t\tconsole.warn( 'THREE.FlyControls: The second parameter \"domElement\" is now mandatory.' );\n\t\tdomElement = document;\n\n\t}\n\n\tthis.object = object;\n\tthis.domElement = domElement;\n\n\tif ( domElement ) this.domElement.setAttribute( 'tabindex', - 1 );\n\n\t// API\n\n\tthis.movementSpeed = 1.0;\n\tthis.rollSpeed = 0.005;\n\n\tthis.dragToLook = false;\n\tthis.autoForward = false;\n\n\t// disable default target object behavior\n\n\t// internals\n\n\tthis.tmpQuaternion = new THREE.Quaternion();\n\n\tthis.mouseStatus = 0;\n\n\tthis.moveState = { up: 0, down: 0, left: 0, right: 0, forward: 0, back: 0, pitchUp: 0, pitchDown: 0, yawLeft: 0, yawRight: 0, rollLeft: 0, rollRight: 0 };\n\tthis.moveVector = new THREE.Vector3( 0, 0, 0 );\n\tthis.rotationVector = new THREE.Vector3( 0, 0, 0 );\n\n\tthis.keydown = function ( event ) {\n\n\t\tif ( event.altKey ) {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t//event.preventDefault();\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase 16: /* shift */ this.movementSpeedMultiplier = .1; break;\n\n\t\t\tcase 87: /*W*/ this.moveState.forward = 1; break;\n\t\t\tcase 83: /*S*/ this.moveState.back = 1; break;\n\n\t\t\tcase 65: /*A*/ this.moveState.left = 1; break;\n\t\t\tcase 68: /*D*/ this.moveState.right = 1; break;\n\n\t\t\tcase 82: /*R*/ this.moveState.up = 1; break;\n\t\t\tcase 70: /*F*/ this.moveState.down = 1; break;\n\n\t\t\tcase 38: /*up*/ this.moveState.pitchUp = 1; break;\n\t\t\tcase 40: /*down*/ this.moveState.pitchDown = 1; break;\n\n\t\t\tcase 37: /*left*/ this.moveState.yawLeft = 1; break;\n\t\t\tcase 39: /*right*/ this.moveState.yawRight = 1; break;\n\n\t\t\tcase 81: /*Q*/ this.moveState.rollLeft = 1; break;\n\t\t\tcase 69: /*E*/ this.moveState.rollRight = 1; break;\n\n\t\t}\n\n\t\tthis.updateMovementVector();\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.keyup = function ( event ) {\n\n\t\tswitch ( event.keyCode ) {\n\n\t\t\tcase 16: /* shift */ this.movementSpeedMultiplier = 1; break;\n\n\t\t\tcase 87: /*W*/ this.moveState.forward = 0; break;\n\t\t\tcase 83: /*S*/ this.moveState.back = 0; break;\n\n\t\t\tcase 65: /*A*/ this.moveState.left = 0; break;\n\t\t\tcase 68: /*D*/ this.moveState.right = 0; break;\n\n\t\t\tcase 82: /*R*/ this.moveState.up = 0; break;\n\t\t\tcase 70: /*F*/ this.moveState.down = 0; break;\n\n\t\t\tcase 38: /*up*/ this.moveState.pitchUp = 0; break;\n\t\t\tcase 40: /*down*/ this.moveState.pitchDown = 0; break;\n\n\t\t\tcase 37: /*left*/ this.moveState.yawLeft = 0; break;\n\t\t\tcase 39: /*right*/ this.moveState.yawRight = 0; break;\n\n\t\t\tcase 81: /*Q*/ this.moveState.rollLeft = 0; break;\n\t\t\tcase 69: /*E*/ this.moveState.rollRight = 0; break;\n\n\t\t}\n\n\t\tthis.updateMovementVector();\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.mousedown = function ( event ) {\n\n\t\tif ( this.domElement !== document ) {\n\n\t\t\tthis.domElement.focus();\n\n\t\t}\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.dragToLook ) {\n\n\t\t\tthis.mouseStatus ++;\n\n\t\t} else {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveState.forward = 1; break;\n\t\t\t\tcase 2: this.moveState.back = 1; break;\n\n\t\t\t}\n\n\t\t\tthis.updateMovementVector();\n\n\t\t}\n\n\t};\n\n\tthis.mousemove = function ( event ) {\n\n\t\tif ( ! this.dragToLook || this.mouseStatus > 0 ) {\n\n\t\t\tvar container = this.getContainerDimensions();\n\t\t\tvar halfWidth = container.size[ 0 ] / 2;\n\t\t\tvar halfHeight = container.size[ 1 ] / 2;\n\n\t\t\tthis.moveState.yawLeft = - ( ( event.pageX - container.offset[ 0 ] ) - halfWidth ) / halfWidth;\n\t\t\tthis.moveState.pitchDown = ( ( event.pageY - container.offset[ 1 ] ) - halfHeight ) / halfHeight;\n\n\t\t\tthis.updateRotationVector();\n\n\t\t}\n\n\t};\n\n\tthis.mouseup = function ( event ) {\n\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\n\t\tif ( this.dragToLook ) {\n\n\t\t\tthis.mouseStatus --;\n\n\t\t\tthis.moveState.yawLeft = this.moveState.pitchDown = 0;\n\n\t\t} else {\n\n\t\t\tswitch ( event.button ) {\n\n\t\t\t\tcase 0: this.moveState.forward = 0; break;\n\t\t\t\tcase 2: this.moveState.back = 0; break;\n\n\t\t\t}\n\n\t\t\tthis.updateMovementVector();\n\n\t\t}\n\n\t\tthis.updateRotationVector();\n\n\t};\n\n\tthis.update = function ( delta ) {\n\n\t\tvar moveMult = delta * this.movementSpeed;\n\t\tvar rotMult = delta * this.rollSpeed;\n\n\t\tthis.object.translateX( this.moveVector.x * moveMult );\n\t\tthis.object.translateY( this.moveVector.y * moveMult );\n\t\tthis.object.translateZ( this.moveVector.z * moveMult );\n\n\t\tthis.tmpQuaternion.set( this.rotationVector.x * rotMult, this.rotationVector.y * rotMult, this.rotationVector.z * rotMult, 1 ).normalize();\n\t\tthis.object.quaternion.multiply( this.tmpQuaternion );\n\n\t\t// expose the rotation vector for convenience\n\t\tthis.object.rotation.setFromQuaternion( this.object.quaternion, this.object.rotation.order );\n\n\n\t};\n\n\tthis.updateMovementVector = function () {\n\n\t\tvar forward = ( this.moveState.forward || ( this.autoForward && ! this.moveState.back ) ) ? 1 : 0;\n\n\t\tthis.moveVector.x = ( - this.moveState.left + this.moveState.right );\n\t\tthis.moveVector.y = ( - this.moveState.down + this.moveState.up );\n\t\tthis.moveVector.z = ( - forward + this.moveState.back );\n\n\t\t//console.log( 'move:', [ this.moveVector.x, this.moveVector.y, this.moveVector.z ] );\n\n\t};\n\n\tthis.updateRotationVector = function () {\n\n\t\tthis.rotationVector.x = ( - this.moveState.pitchDown + this.moveState.pitchUp );\n\t\tthis.rotationVector.y = ( - this.moveState.yawRight + this.moveState.yawLeft );\n\t\tthis.rotationVector.z = ( - this.moveState.rollRight + this.moveState.rollLeft );\n\n\t\t//console.log( 'rotate:', [ this.rotationVector.x, this.rotationVector.y, this.rotationVector.z ] );\n\n\t};\n\n\tthis.getContainerDimensions = function () {\n\n\t\tif ( this.domElement != document ) {\n\n\t\t\treturn {\n\t\t\t\tsize: [ this.domElement.offsetWidth, this.domElement.offsetHeight ],\n\t\t\t\toffset: [ this.domElement.offsetLeft, this.domElement.offsetTop ]\n\t\t\t};\n\n\t\t} else {\n\n\t\t\treturn {\n\t\t\t\tsize: [ window.innerWidth, window.innerHeight ],\n\t\t\t\toffset: [ 0, 0 ]\n\t\t\t};\n\n\t\t}\n\n\t};\n\n\tfunction bind( scope, fn ) {\n\n\t\treturn function () {\n\n\t\t\tfn.apply( scope, arguments );\n\n\t\t};\n\n\t}\n\n\tfunction contextmenu( event ) {\n\n\t\tevent.preventDefault();\n\n\t}\n\n\tthis.dispose = function () {\n\n\t\tthis.domElement.removeEventListener( 'contextmenu', contextmenu, false );\n\t\tthis.domElement.removeEventListener( 'mousedown', _mousedown, false );\n\t\tthis.domElement.removeEventListener( 'mousemove', _mousemove, false );\n\t\tthis.domElement.removeEventListener( 'mouseup', _mouseup, false );\n\n\t\twindow.removeEventListener( 'keydown', _keydown, false );\n\t\twindow.removeEventListener( 'keyup', _keyup, false );\n\n\t};\n\n\tvar _mousemove = bind( this, this.mousemove );\n\tvar _mousedown = bind( this, this.mousedown );\n\tvar _mouseup = bind( this, this.mouseup );\n\tvar _keydown = bind( this, this.keydown );\n\tvar _keyup = bind( this, this.keyup );\n\n\tthis.domElement.addEventListener( 'contextmenu', contextmenu, false );\n\n\tthis.domElement.addEventListener( 'mousemove', _mousemove, false );\n\tthis.domElement.addEventListener( 'mousedown', _mousedown, false );\n\tthis.domElement.addEventListener( 'mouseup', _mouseup, false );\n\n\twindow.addEventListener( 'keydown', _keydown, false );\n\twindow.addEventListener( 'keyup', _keyup, false );\n\n\tthis.updateMovementVector();\n\tthis.updateRotationVector();\n\n};\n"]}